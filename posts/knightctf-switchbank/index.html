<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>KnightCTF SwitchBank - LexterSecurity</title><meta name="Description" content="Fun research blog "><meta property="og:title" content="KnightCTF SwitchBank" />
<meta property="og:description" content="KnightCTF - Knight Switch bank Nom Knight Switch Bank Points 200 Difficulté Facile Validation 173 Bonjour, je vous présente aujourd’hui ma writeup sur le challenge de Reverse Knight Switch bank du CTF KnightCTF.
Commençons par le commencement, tout d’abord lançons le binaire.
Analyse et compréhensions du binaire Lorsque nous lançons le binaire on peut voir qu’il demande un mot de passe. On peut potentiellement en conclure que le mot de passe est en dur dans le code du binaire, mais qu’il y a un algorithme à reverse." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/posts/knightctf-switchbank/" /><meta property="og:image" content="http://example.org/img/logo.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-04T04:38:26+02:00" />
<meta property="article:modified_time" content="2023-09-04T04:38:26+02:00" /><meta property="og:site_name" content="LexterSecurity - Blog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.org/img/logo.jpg"/>

<meta name="twitter:title" content="KnightCTF SwitchBank"/>
<meta name="twitter:description" content="KnightCTF - Knight Switch bank Nom Knight Switch Bank Points 200 Difficulté Facile Validation 173 Bonjour, je vous présente aujourd’hui ma writeup sur le challenge de Reverse Knight Switch bank du CTF KnightCTF.
Commençons par le commencement, tout d’abord lançons le binaire.
Analyse et compréhensions du binaire Lorsque nous lançons le binaire on peut voir qu’il demande un mot de passe. On peut potentiellement en conclure que le mot de passe est en dur dans le code du binaire, mais qu’il y a un algorithme à reverse."/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/posts/knightctf-switchbank/" /><link rel="prev" href="http://example.org/posts/config-loader-hacksecureims/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "KnightCTF SwitchBank",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/posts\/knightctf-switchbank\/"
        },"genre": "posts","wordcount":  2260 ,
        "url": "http:\/\/example.org\/posts\/knightctf-switchbank\/","datePublished": "2023-09-04T04:38:26+02:00","dateModified": "2023-09-04T04:38:26+02:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Lxt3h"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="LexterSecurity"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/bryton.png"
        data-srcset="/img/bryton.png, /img/bryton.png 1.5x, /img/bryton.png 2x"
        data-sizes="auto"
        alt="/img/bryton.png"
        title="/img/bryton.png" width="128" height="128" />LexterSecurity</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="LexterSecurity"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/bryton.png"
        data-srcset="/img/bryton.png, /img/bryton.png 1.5x, /img/bryton.png 2x"
        data-sizes="auto"
        alt="/img/bryton.png"
        title="/img/bryton.png" width="128" height="128" />LexterSecurity</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">KnightCTF SwitchBank</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Lxt3h</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-09-04">2023-09-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2260 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;11 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#analyse-et-compréhensions-du-binaire">Analyse et compréhensions du binaire</a>
      <ul>
        <li><a href="#1-ère-étape-de-lalgorithme">1 ère étape de l’algorithme</a></li>
        <li><a href="#2-ème-étape-de-lalgorithme">2 ème étape de l’algorithme</a></li>
        <li><a href="#3-ème-étape-de-lalgorithme">3 ème étape de l’algorithme</a></li>
      </ul>
    </li>
    <li><a href="#reverse-lalgorithme">Reverse l’algorithme</a>
      <ul>
        <li><a href="#conception-dun-script-permettant-de-reverse-lalgorithme">Conception d’un script permettant de reverse l’algorithme</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="knightctf---knight-switch-bank">KnightCTF - Knight Switch bank</h1>
<table>
<thead>
<tr>
<th>Nom</th>
<th>Knight Switch Bank</th>
</tr>
</thead>
<tbody>
<tr>
<td>Points</td>
<td>200</td>
</tr>
<tr>
<td>Difficulté</td>
<td>Facile</td>
</tr>
<tr>
<td>Validation</td>
<td>173</td>
</tr>
</tbody>
</table>
<p>Bonjour, je vous présente aujourd’hui ma writeup sur le challenge de Reverse Knight Switch bank du CTF KnightCTF.</p>
<p>Commençons par le commencement, tout d’abord lançons le binaire.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="KnightCTF%20-%20Knight%20Switch%20bank%20925d96a4f7504cb5a23fcb0d7a2d40c0/Untitled.png"
        data-srcset="KnightCTF%20-%20Knight%20Switch%20bank%20925d96a4f7504cb5a23fcb0d7a2d40c0/Untitled.png, KnightCTF%20-%20Knight%20Switch%20bank%20925d96a4f7504cb5a23fcb0d7a2d40c0/Untitled.png 1.5x, KnightCTF%20-%20Knight%20Switch%20bank%20925d96a4f7504cb5a23fcb0d7a2d40c0/Untitled.png 2x"
        data-sizes="auto"
        alt="KnightCTF%20-%20Knight%20Switch%20bank%20925d96a4f7504cb5a23fcb0d7a2d40c0/Untitled.png"
        title="Untitled" /></p>
<h2 id="analyse-et-compréhensions-du-binaire">Analyse et compréhensions du binaire</h2>
<p>Lorsque nous lançons le binaire on peut voir qu’il demande un mot de passe. On peut potentiellement en conclure que le mot de passe est en dur dans le code du binaire, mais qu’il y a un algorithme à reverse. C’est partit récupérons le pseudo code.</p>
<table>
<thead>
<tr>
<th>Fonctions du binaire</th>
</tr>
</thead>
<tbody>
<tr>
<td>main</td>
</tr>
<tr>
<td>winner</td>
</tr>
</tbody>
</table>
<p>En effet on peut obsérver qu’il existe seulement deux fonctions dans le binaire. En allant voir dans le winner j’ai vu que cela affichait simplement une chaine de caractère m’indiquant que le mot de passe rentré était correct. Nous allons donc analyser la fonction main.</p>
<p>Main:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">undefined8</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_430h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_230h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_30h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_28h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_20h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_18h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int32_t</span> <span class="n">var_10h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">var_9h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int32_t</span> <span class="n">var_8h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int64_t</span> <span class="n">var_4h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">var_30h</span> <span class="o">=</span> <span class="mh">0x4164485d5549525a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_28h</span> <span class="o">=</span> <span class="mh">0x41494447414a644e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_20h</span> <span class="o">=</span> <span class="mh">0x4173444476414978</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_18h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="mh">0x71444479</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_18h</span><span class="p">.</span><span class="n">_4_2_</span> <span class="o">=</span> <span class="mh">0x5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_4h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_8h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="mh">0x402008</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">Knight Switch Bank&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="mh">0x402048</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Welcome to Knight Switch Bank....&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Please enter your password : &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__isoc99_scanf</span><span class="p">(</span><span class="mh">0x402130</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">var_230h</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_4h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;A&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="sc">&#39;M&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;a&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="sc">&#39;m&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;N&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                   <span class="p">(</span><span class="sc">&#39;Z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;n&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="sc">&#39;z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                         <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                     <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                 <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_8h</span> <span class="o">=</span> <span class="n">var_8h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\x02&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_9h</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_10h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_30h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_10h</span><span class="p">)</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">code_r0x00401437</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">var_9h</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Oh My God ! You entered a wrong password.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">winner</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_30h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_10h</span><span class="p">)</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_10h</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">var_9h</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">goto</span> <span class="n">code_r0x00401437</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_9h</span> <span class="o">=</span> <span class="sc">&#39;\x01&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_10h</span> <span class="o">=</span> <span class="n">var_10h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Voilà donc le contenu de notre fonction main. Je vous propose d’analyser le code étape par étape.</p>
<p>Je vais vous épargner les déclarations de variables ce serait inutile allons directement à l’essentiel.</p>
<h3 id="1-ère-étape-de-lalgorithme">1 ère étape de l’algorithme</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">		<span class="n">var_30h</span> <span class="o">=</span> <span class="mh">0x4164485d5549525a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_28h</span> <span class="o">=</span> <span class="mh">0x41494447414a644e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_20h</span> <span class="o">=</span> <span class="mh">0x4173444476414978</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_18h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="mh">0x71444479</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_18h</span><span class="p">.</span><span class="n">_4_2_</span> <span class="o">=</span> <span class="mh">0x5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_4h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_8h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="mh">0x402008</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t</span><span class="s">Knight Switch Bank&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="mh">0x402048</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Welcome to Knight Switch Bank....&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Please enter your password : &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__isoc99_scanf</span><span class="p">(</span><span class="mh">0x402130</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">var_230h</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_4h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;A&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="sc">&#39;M&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;a&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="sc">&#39;m&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;N&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                   <span class="p">(</span><span class="sc">&#39;Z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;n&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="sc">&#39;z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                         <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                     <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                 <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>Comme vous pouvez le voir il y a tout d’abord des initialisation de variable on peut donc en conclure assez facilement que ce sont potentiellement les chaines correspondant au flag.</p>
<p>Mais nous verrons à la fin si c’est bien cela.</p>
<p>Ensuite si on lit bien le code on voit qu’il fait un simple scanf il va simplement mettre le contenu que l’on écrit dans le STDIN dans le buffer.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_4h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;A&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="sc">&#39;M&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;a&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="sc">&#39;m&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;N&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                   <span class="p">(</span><span class="sc">&#39;Z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;n&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="sc">&#39;z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                         <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                     <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                 <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>En effet rappelez vous notre variable du buffer s’appelle var_230h. Le code ci-dessus est plutot simple nous allons simplement parcourirs la chaine rentré dans le scanf. D’ou la boucle for dans cette boucle il va y avoir des actions très intéressante. Alors écoutez bien.</p>
<p>Tout d’abord la première vérification est super simple il va regarder si la valeur de notre caractère n’est pas comprise entre ‘A’ et ‘M’ si ce n’est pas le cas et bien il va prendre une variable qu’il aura initialisé juste avant la boucle et il y inserera la somme de notre caractère + ‘\r’</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                 <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">input</span> <span class="o">=</span> <span class="sc">&#39;K&#39;</span> <span class="c1">// K est bien dans l&#39;interval de A et M donc il rentrera dans le else
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="o">+</span><span class="nf">ord</span><span class="p">(</span><span class="sc">&#39;\r&#39;</span><span class="p">)</span> <span class="c1">// soit 75+13
</span></span></span><span class="line"><span class="cl"><span class="c1">//=&gt; 88
</span></span></span></code></pre></div><p>Donc voilà ça c’est l’opération qui ce passera seulement si le caractère est compris entre ‘A’ et ‘M’</p>
<p>En revanche si celui-ci n’est pas contenu entre les deux l’algorithme va rentrer dans une autre condition qui vérifie si idem la lettre n’est pas contenu entre ‘a’ et ‘m’ si tel est le cas il refait la même opération que pour le premier.</p>
<p>Si du coup le caractère n’est pas compris entre ‘a’ et ‘m’ il rentre dans une condition verifiant si le caractère n’est pas compris entre ‘N’ et ‘Z’ si le caractère en question est compris entre ‘N’ et ‘Z’ nous rentrons dans le else.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">              <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">             
</span></span></code></pre></div><p>Rien de bien compliquer, il prend le caractère actuel et il le soustrait à 0xd.</p>
<p>Petit exemple en pseudo code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">input</span> <span class="o">=</span> <span class="sc">&#39;X&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="o">-</span><span class="mh">0xd</span> <span class="c1">// soit 88-0xd ou 88-1
</span></span></span><span class="line"><span class="cl"><span class="c1">//=&gt; 75
</span></span></span></code></pre></div><p>Et il fait également la même procédure pour les minuscule. Maintenant si toute ces conditions sont correctes. Il soustrait 0x20 au caracère actuel, c’est dans le cas ou y a des caractères spéciaux.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                     <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x20</span><span class="p">;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">input</span> <span class="o">=</span> <span class="sc">&#39;{&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="o">-</span><span class="mh">0x20</span> <span class="c1">// soit 123-0x20
</span></span></span><span class="line"><span class="cl"><span class="c1">//=&gt; 91
</span></span></span></code></pre></div><p>Parfait nous avons donc réussi à comprendre la première étape de l’algorithme.</p>
<h3 id="2-ème-étape-de-lalgorithme">2 ème étape de l’algorithme</h3>
<p>La deuxième étape est la plus simple de toute car elle ne comporte que très peu de code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_8h</span> <span class="o">=</span> <span class="n">var_8h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">=</span> 
</span></span><span class="line"><span class="cl">							<span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\x02&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Le code est très simple il va simplement parcourir toute la chaine de caractère que l’on a instancié juste avant dans la 1ère étape, il va ensuite simplement remplacer chaque caractère par le caractère actuel+ 2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">input</span> <span class="o">=</span> <span class="sc">&#39;A&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="o">+</span><span class="mh">0x2</span> <span class="c1">// 65+0x20
</span></span></span><span class="line"><span class="cl"><span class="c1">//=&gt; 67
</span></span></span></code></pre></div><p>Y a rien de plus à dire sur cette étape c’est tout ce qu’elle fait 🙂.</p>
<h3 id="3-ème-étape-de-lalgorithme">3 ème étape de l’algorithme</h3>
<p>Bon nous allons essayer de comprendre la 3 ème et dernière étape de l’algorithme. Elle est toute simple car ce n’est que la partie qui verifie si le flag est bon ou mauvais.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">var_9h</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">var_10h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_30h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_10h</span><span class="p">)</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">code_r0x00401437</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">var_9h</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Oh My God ! You entered a wrong password.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">winner</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_30h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_10h</span><span class="p">)</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_10h</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">var_9h</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">goto</span> <span class="n">code_r0x00401437</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_9h</span> <span class="o">=</span> <span class="sc">&#39;\x01&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_10h</span> <span class="o">=</span> <span class="n">var_10h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
</span></span></code></pre></div><p>Je ne vais pas trop m’attarder car le code est relativement compréhensible. Mais en gros on va itérer sur la chaine qui stock une des parties du flag.</p>
<p>Celle-ci:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">var_30h</span> <span class="o">=</span> <span class="mh">0x4164485d5549525a</span><span class="p">;</span>
</span></span></code></pre></div><p>Puis à la fin on verifie sur le caractère actuel du flag est égal au caractère actuel de notre buffer. C’est maintenant qu’on peut en conclure que var_30h et le reste stock bien notre flag. Notre mission si on l’accepte est de reverse l’algorithme.</p>
<h2 id="reverse-lalgorithme">Reverse l’algorithme</h2>
<p>Ce qui est important dans cet algorithme c’est que l’on va devoir vraiment faire les étapes au sens inverse. C’est à dire que nous allons d’abord devoir reverse la 2 ème step et ensuite la 1 ère pour avoir la chaine final.</p>
<p>Avant tout on sait que notre debut de flag sera forcément KCTF{. On a donc déjà un petit indice pour l’exploitation.</p>
<p>Commençons par prendre le dernier byte de var_30h étant donné que c’est censé être le ‘K’ on va facilement pouvoir comprendre comment reverse.</p>
<p>flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">var_30h</span> <span class="o">=</span> <span class="mh">0x4164485d5549525a</span><span class="p">;</span>
</span></span></code></pre></div><p>Donc reprenons notre step 2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_8h</span> <span class="o">=</span> <span class="n">var_8h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">=</span> 
</span></span><span class="line"><span class="cl">							<span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span><span class="n">var_8h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\x02&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Rappelez vous notre step 2 prend chaque caractère de la chaine final et lui ajoute 2. Il n’y a pas besoin d’un doctorat en mathématique pour comprendre que pour reverse cette step nous allons simplement devoir soustraire 2 à notre byte.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">byte</span> <span class="o">=</span> <span class="mh">0x5a</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">((</span><span class="n">byte</span><span class="o">-</span><span class="mh">0x2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">#=&gt;88 soit =&gt; &#39;X&#39;</span>
</span></span></code></pre></div><p>Parfait nous avons reverse la 2 ème step à présent il va falloir simplement que je reverse la 1 ère step c’est partit.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="n">var_4h</span><span class="p">.</span><span class="n">_0_4_</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;A&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="sc">&#39;M&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;a&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="sc">&#39;m&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;N&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                   <span class="p">(</span><span class="sc">&#39;Z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="sc">&#39;n&#39;</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="sc">&#39;z&#39;</span> <span class="o">&lt;</span> <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                             <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                         <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0xd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                     <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_430h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">                 <span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)((</span><span class="kt">int64_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">var_230h</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int64_t</span><span class="p">)(</span><span class="kt">int32_t</span><span class="p">)</span><span class="n">var_4h</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\r&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>Donc ce que nous savons de cette partie c’est que si l’on met une lettre majuscule ou minuscule compris entre ‘a’ et ‘m’ et bien nous rentrons dans le else.</p>
<p>On sait que notre premier caractère est forcément ‘K’</p>
<p>Alors bruteforçons voir le quel à la fin obtiendra une lettre cohérente.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">byte</span> <span class="o">=</span> <span class="mh">0x5a</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">((</span><span class="n">byte</span><span class="o">-</span><span class="mh">0x2</span><span class="p">)</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span> <span class="c1"># on soustrait à notre byte reversé 13 car 13 équivaut à la valeur</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ascii de &#39;\r&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#=&gt; 75 soit &#39;K&#39;</span>
</span></span></code></pre></div><p>à présent je vous propose donc de scripter tout cela.</p>
<h3 id="conception-dun-script-permettant-de-reverse-lalgorithme">Conception d’un script permettant de reverse l’algorithme</h3>
<p>Donc en effet nous avons compris comment reverse les lettres entre ‘A’ et ‘M’ ou a et ‘m’</p>
<p>Le problème est : “Comment je vais savoir quel algorithme appliquer à ma lettre sans savoir à l’avance son range ?”. Rien de plus simple ce que j’ai fais c’est simplement de bruteforce.</p>
<p>Voici un petit exemple:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">byte</span><span class="o">-</span><span class="mh">0x2</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">algo_range_a_m</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="p">(</span><span class="n">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">algo_range_n_z</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="p">(</span><span class="n">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="o">+</span><span class="mh">0xd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">step1</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">algo_operation1</span> <span class="o">=</span> <span class="n">algo_range_a_m</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">algo_operation2</span> <span class="o">=</span> <span class="n">algo_range_n_z</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">algo_operation3</span> <span class="o">=</span> <span class="p">(</span><span class="n">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="o">+</span><span class="mh">0x20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="n">algo_operation1</span> <span class="o">&gt;=</span> <span class="s1">&#39;A&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation1</span> <span class="o">&lt;=</span> <span class="s1">&#39;M&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span> <span class="o">||</span><span class="p">(</span><span class="n">algo_operation1</span> <span class="o">&gt;=</span> <span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation1</span> <span class="o">&lt;=</span> <span class="s1">&#39;m&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">algo_operation1</span><span class="o">.</span><span class="n">chr</span>
</span></span><span class="line"><span class="cl">    <span class="k">elsif</span> <span class="p">(</span><span class="n">algo_operation2</span> <span class="o">&gt;=</span> <span class="s1">&#39;N&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation2</span> <span class="o">&lt;=</span> <span class="s1">&#39;Z&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">algo_operation2</span> <span class="o">&gt;=</span> <span class="s1">&#39;n&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation2</span> <span class="o">&lt;=</span> <span class="s1">&#39;z&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">algo_operation2</span><span class="o">.</span><span class="n">chr</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">algo_operation3</span><span class="o">.</span><span class="n">chr</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><p>Donc pour la petite explication je vais simplement appliquer chaque algorithme à chaque caractère et comparer en gros si par exemple le résultat est dans les ranges si tel est le cas on renvois la valeur correspondant au range.</p>
<p>Voici le script de fin qui reverse nos chaines de caractères. ;)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">byte</span><span class="o">-</span><span class="mh">0x2</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">algo_range_a_m</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">algo_range_n_z</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="o">+</span><span class="mh">0xd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">step1</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">algo_operation1</span> <span class="o">=</span> <span class="n">algo_range_a_m</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">algo_operation2</span> <span class="o">=</span> <span class="n">algo_range_n_z</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">algo_operation3</span> <span class="o">=</span> <span class="p">(</span><span class="n">step2</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="o">+</span><span class="mh">0x20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">algo_operation1</span> <span class="o">&gt;=</span> <span class="s1">&#39;A&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation1</span> <span class="o">&lt;=</span> <span class="s1">&#39;M&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span> <span class="o">||</span><span class="p">(</span><span class="n">algo_operation1</span> <span class="o">&gt;=</span> <span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation1</span> <span class="o">&lt;=</span> <span class="s1">&#39;m&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">algo_operation1</span><span class="o">.</span><span class="n">chr</span>
</span></span><span class="line"><span class="cl">    <span class="k">elsif</span> <span class="p">(</span><span class="n">algo_operation2</span> <span class="o">&gt;=</span> <span class="s1">&#39;N&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation2</span> <span class="o">&lt;=</span> <span class="s1">&#39;Z&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">algo_operation2</span> <span class="o">&gt;=</span> <span class="s1">&#39;n&#39;</span><span class="o">.</span><span class="n">ord</span> <span class="o">&amp;&amp;</span> <span class="n">algo_operation2</span> <span class="o">&lt;=</span> <span class="s1">&#39;z&#39;</span><span class="o">.</span><span class="n">ord</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">algo_operation2</span><span class="o">.</span><span class="n">chr</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">algo_operation3</span><span class="o">.</span><span class="n">chr</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">text0</span> <span class="o">=</span> <span class="o">[</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x5d</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0x5a</span><span class="o">].</span><span class="n">reverse</span>
</span></span><span class="line"><span class="cl">    <span class="n">text1</span> <span class="o">=</span> <span class="o">[</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x4a</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x4e</span><span class="o">].</span><span class="n">reverse</span>
</span></span><span class="line"><span class="cl">    <span class="n">text2</span> <span class="o">=</span> <span class="o">[</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x78</span><span class="o">].</span><span class="n">reverse</span>
</span></span><span class="line"><span class="cl">    <span class="n">text3</span> <span class="o">=</span> <span class="o">[</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x79</span><span class="o">].</span><span class="n">reverse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="o">[]</span>
</span></span><span class="line"><span class="cl">    <span class="mi">4</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp_flag</span> <span class="o">=</span> <span class="o">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">eval</span><span class="p">(</span><span class="s2">&#34;text</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">            <span class="n">tmp_flag</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">step1</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">flag</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">tmp_flag</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">puts</span> <span class="s2">&#34;Flag: </span><span class="si">#{</span><span class="n">flag</span><span class="o">.</span><span class="n">join</span><span class="si">}</span><span class="s2">}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="bp">__FILE__</span> <span class="o">==</span> <span class="vg">$0</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="ss">Flag</span><span class="p">:</span> <span class="no">KCTF</span><span class="p">{</span><span class="no">So_YoU_ROT_iT_gOOd_jOOb</span><span class="p">}</span>
</span></span></code></pre></div><p>Sur ce je vous souhaite une bonne journée 🙂</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-09-04</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.org/posts/knightctf-switchbank/" data-title="KnightCTF SwitchBank"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.org/posts/knightctf-switchbank/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://example.org/posts/knightctf-switchbank/" data-title="KnightCTF SwitchBank"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://example.org/posts/knightctf-switchbank/" data-title="KnightCTF SwitchBank"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://example.org/posts/knightctf-switchbank/" data-title="KnightCTF SwitchBank"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/config-loader-hacksecureims/" class="prev" rel="prev" title="Config Loader HackSecuReims"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Config Loader HackSecuReims</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.118.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Lxt3h</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
